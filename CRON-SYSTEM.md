# ุณุณุชู Cron Job ุฎูุฏฺฉุงุฑ

## ๐ ูุงุจูุชโูุง ุณุณุชู

### โ **ุงุฌุฑุง ุฎูุฏฺฉุงุฑ**
- **ุชููุฏ ุฎูุฏฺฉุงุฑ ููุงูุงุช** ุฏุฑ ุฒูุงูโูุง ูุดุฎุต
- **ุจุฏูู ูุงุฒ ุจู ุฏุฎุงูุช ุฏุณุช** - ฺฉุงููุงู ุฎูุฏฺฉุงุฑ
- **ุฒูุงูโุจูุฏ ูุงุจู ุชูุธู** (ุฑูุฒุงููุ ููุชฺฏุ ูุงูุงูู)
- **ุจุฑุฑุณ ูุฑ ุณุงุนุช** ุจุฑุง ุงุฌุฑุง ุฒูุงูโุจูุฏ ุดุฏู

### โ๏ธ **ุชูุธูุงุช**

#### ูุงู: `data/cron-settings.json`
```json
{
  "enabled": true,           // ูุนุงู/ุบุฑูุนุงู
  "interval": "daily",       // daily, weekly, monthly
  "postsPerRun": 2,          // ุชุนุฏุงุฏ ููุงูุงุช ุฏุฑ ูุฑ ุงุฌุฑุง
  "lastRun": null,           // ุขุฎุฑู ุงุฌุฑุง
  "scheduleTime": "09:00",   // ุฒูุงู ุงุฌุฑุง
  "timezone": "Asia/Tehran", // ููุทูู ุฒูุงู
  "topics": [...]            // ูุณุช ููุถูุนุงุช
}
```

## ๐ง **ูุญูู ุงุณุชูุงุฏู**

### 1. **ุดุฑูุน ุณุณุชู Cron**
```bash
# ุฑูุด 1: ุงุฒ ุทุฑู npm script
npm run start-cron

# ุฑูุด 2: ุงุฒ ุทุฑู API
curl -X POST http://localhost:3000/api/cron-control \
  -H "Content-Type: application/json" \
  -d '{"action": "start"}'
```

### 2. **ุชุณุช ุณุณุชู**
```bash
npm run test-cron
```

### 3. **ุจุฑุฑุณ ูุถุนุช**
```bash
curl http://localhost:3000/api/cron-control
```

### 4. **ุงุฌุฑุง ุฏุณุช (ููุฑ)**
```bash
curl -X POST http://localhost:3000/api/cron \
  -H "Content-Type: application/json" \
  -d '{"action": "run-cron", "force": true}'
```

## ๐ **API Endpoints**

### 1. **ฺฉูุชุฑู Cron**
```
GET /api/cron-control          # ูุถุนุช
POST /api/cron-control         # ุดุฑูุน/ุชููู
```

### 2. **ุงุฌุฑุง Cron**
```
POST /api/cron                 # ุงุฌุฑุง ุฏุณุช
```

## ๐ **ูุญูู ฺฉุงุฑฺฉุฑุฏ**

### **ุฒูุงูโุจูุฏ:**
- **ุฑูุฒุงูู**: ูุฑ 24 ุณุงุนุช ฺฉุจุงุฑ
- **ููุชฺฏ**: ูุฑ 7 ุฑูุฒ ฺฉุจุงุฑ  
- **ูุงูุงูู**: ูุฑ 30 ุฑูุฒ ฺฉุจุงุฑ

### **ูุฑุขูุฏ:**
1. **ุจุฑุฑุณ ุฒูุงู**: ุณุณุชู ูุฑ ุณุงุนุช ุจุฑุฑุณ ูโฺฉูุฏ
2. **ุชุดุฎุต ูุงุฒ**: ุงฺฏุฑ ุฒูุงู ุงุฌุฑุง ุฑุณุฏู ุจุงุดุฏ
3. **ุชููุฏ ูุญุชูุง**: ุจุง Gemini AI
4. **ุฐุฎุฑู ุฎูุฏฺฉุงุฑ**: ุฏุฑ ูุงู blog-posts.json
5. **ุจูโุฑูุฒุฑุณุงู**: ุฒูุงู ุขุฎุฑู ุงุฌุฑุง

## ๐งช **ุชุณุช ุณุณุชู**

### **ูุฑุงุญู ุชุณุช:**
```bash
# 1. ุดุฑูุน ุณุฑูุฑ
npm run dev

# 2. ุชุณุช ุณุณุชู Cron
npm run test-cron

# 3. ุจุฑุฑุณ ููุงูุงุช ุชููุฏ ุดุฏู
# ูุงู: data/blog-posts.json
```

### **ุฎุฑูุฌ ููุฑุฏ ุงูุชุธุงุฑ:**
```
๐งช Cron Job System Test Suite
==============================

โ๏ธ Testing Cron Settings
========================
โ Cron settings found:
  - Enabled: true
  - Interval: daily
  - Posts per run: 2
  - Last run: null
  - Topics count: 10

๐ค Testing Gemini Settings
===========================
โ Gemini settings found:
  - API Key: Configured
  - Model: gemini-pro
  - Enabled: true

๐ 1. Checking cron status...
โ Cron status: { running: false, lastRun: null, nextRun: 'ุงฺฉููู' }

๐ 2. Starting cron scheduler...
โ Cron scheduler started: ุณุณุชู Cron ุดุฑูุน ุดุฏ

โก 3. Force running cron job...
โ Cron job executed: 2 ููุงูู ุจุง ููููุช ุชููุฏ ุดุฏ
๐ Generated posts: 2
  1. ุฑุงูููุง ฺฉุงูู ุชุนูุฑ ููุชูุฑ BMW X5
  2. ุชุนูุฑ ฺฏุฑุจฺฉุณ ุงุชููุงุชฺฉ CVT

๐ 4. Final cron status...
โ Final cron status: { running: true, lastRun: '2025-01-14T...', nextRun: 'ูุฑุฏุง' }

๐ 5. Checking blog posts...
โ Total blog posts: 2
๐ Latest posts:
  1. ุฑุงูููุง ฺฉุงูู ุชุนูุฑ ููุชูุฑ BMW X5 (2025-01-14T...)
  2. ุชุนูุฑ ฺฏุฑุจฺฉุณ ุงุชููุงุชฺฉ CVT (2025-01-14T...)
```

## ๐ฏ **ูุฒุงุง ุณุณุชู**

### โ **ุฎูุฏฺฉุงุฑ ุจูุฏู**
- **ุจุฏูู ุฏุฎุงูุช ุฏุณุช** - ฺฉุงููุงู ุฎูุฏฺฉุงุฑ
- **ุฒูุงูโุจูุฏ ุฏูู** - ุฏุฑ ุฒูุงูโูุง ูุดุฎุต
- **ูุฏุงูู ุจูุฏู** - 24/7 ูุนุงู

### โ **ูุงุจูุช ุชูุธู**
- **ุฒูุงูโุจูุฏ ูุงุจู ุชุบุฑ** - ุฑูุฒุงูู/ููุชฺฏ/ูุงูุงูู
- **ุชุนุฏุงุฏ ููุงูุงุช ูุงุจู ุชูุธู** - 1 ุชุง 10 ููุงูู
- **ููุถูุนุงุช ูุงุจู ุงูุชุฎุงุจ** - 10 ููุถูุน ุชุฎุตุต

### โ **ฺฉูุช ูุญุชูุง**
- **ููุงูุงุช ุนูู** - 1500-2500 ฺฉููู
- **ูุญุชูุง ุชุฎุตุต** - ุจุฑุง ุฎูุฏุฑููุง ุขููุงู ู ฺู
- **SEO ุจููู** - ฺฉููุงุช ฺฉูุฏ ูุฏูููุฏ

## ๐ **ูุญูู ูุธุงุฑุช**

### **ุจุฑุฑุณ ูุถุนุช:**
```javascript
// ุงุฒ ุทุฑู API
fetch('/api/cron-control')
  .then(r => r.json())
  .then(data => console.log(data));

// ุฎุฑูุฌ:
{
  "success": true,
  "data": {
    "running": true,
    "lastRun": "2025-01-14T09:00:00.000Z",
    "nextRun": "ูุฑุฏุง"
  }
}
```

### **ุจุฑุฑุณ ููุงูุงุช:**
```javascript
// ูุงู: data/blog-posts.json
// ุขุฎุฑู ููุงูุงุช ุชููุฏ ุดุฏู
```

## ๐จ **ูฺฉุงุช ููู**

### **ูุจู ุงุฒ ุงุณุชูุงุฏู:**
1. โ **Gemini API Key** ุชูุธู ุดุฏู ุจุงุดุฏ
2. โ **ุณุฑูุฑ ุฏุฑ ุญุงู ุงุฌุฑุง** ุจุงุดุฏ
3. โ **ุณุณุชู Cron ุดุฑูุน** ุดุฏู ุจุงุดุฏ

### **ุจุฑุง ุชููุฏ:**
1. ๐ **ุฒูุงูโุจูุฏ** ุฑุง ุชูุธู ฺฉูุฏ
2. ๐ฏ **ููุถูุนุงุช** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
3. ๐ **ุชุนุฏุงุฏ ููุงูุงุช** ุฑุง ูุดุฎุต ฺฉูุฏ
4. ๐ **ุณุณุชู ุฑุง ุดุฑูุน** ฺฉูุฏ

## ๐ **ูุชุฌู**

ุณุณุชู Cron Job ุดูุง ุญุงูุง ฺฉุงููุงู ุฎูุฏฺฉุงุฑ ุงุณุช ู ูโุชูุงูุฏ:
- **ุฑูุฒุงูู 2 ููุงูู** ุชููุฏ ฺฉูุฏ
- **ุจุฏูู ุฏุฎุงูุช ุฏุณุช** ฺฉุงุฑ ฺฉูุฏ
- **ุฏุฑ ุฒูุงูโูุง ูุดุฎุต** ุงุฌุฑุง ุดูุฏ
- **ูุญุชูุง ุจุงฺฉูุช** ุชููุฏ ฺฉูุฏ

**ุจุฑุง ุดุฑูุน:** `npm run start-cron` ๐
